# User Story 009.1: Implement Diary Entry Form - Part 1 (Basic Structure and Text Fields)

## 1. Title

Implement the basic structure of the diary entry form and text-based input fields using shared UI components.

## 2. Goal

To create the foundational structure for the diary entry form and implement the text-based input fields ('Food Eaten', 'Description', 'Date', 'Time') using components from the shared UI package (`@repo/ui`).

## 3. Description

As a developer, I need to start building the diary entry form by setting up the basic component structure and implementing the simpler text-based input fields. This is the first part of creating the complete diary entry form, using the shared UI components we built in previous stories.

## 4. Technical Details

- **React Component:** Create `EntryForm.tsx` in `apps/food-diary/src/components/`
- **Shared UI Components:** Use RAC `Form` plus `TextField` and `DatePicker` from `@repo/ui`
- **Form Structure:** Client form component with RAC form semantics and validation
- **State Management:** Use `useState` for form fields (client component needed for form state)
- **Validation:** RAC field-level validation for immediate feedback; server-side Zod validation in action layer
- **i18n:** All labels and text should use `useTranslations` from next-intl

## 5. Steps to Implement

1. **Create `EntryForm` Component File:**
   - Create `apps/food-diary/src/components/EntryForm.tsx`
   - Add `"use client"` directive (needed for form state)

2. **Import Necessary Modules:**
   - Import `useState` from 'react'
   - Import `Form` from `react-aria-components`
   - Import `TextField`, `DatePicker`, and `Button` from `@repo/ui`
   - Import `useTranslations` from 'next-intl'
   - Import form-related translations

3. **Define `EntryForm` Functional Component:**
   - Define functional component `EntryForm`
   - Accept optional props for editing existing entry (to be used later)

4. **Implement State Variables:**
   - Use `useState` for `foodEaten`, `description`, `date`, `time`
   - Initialize as empty strings (or from props if editing)

5. **Implement Basic Form Structure:**
   - Create RAC `Form` element with `onSubmit` handler
   - Use shared UI components for layout and field composition
   - Implement `handleSubmit` function that logs form data (will be replaced with server action in later story)

6. **Implement Text Fields:**
   - Use `TextField` component from `@repo/ui` for 'Food Eaten'
   - Use `TextField` component for 'Description' (multiline)
   - Use `DatePicker` component from `@repo/ui` for 'Date'
   - Use `TextField` with `type="time"` for 'Time' field
   - Connect each field to its corresponding state variable
   - Add RAC-compatible validation attributes and `FieldError` slots
   - Add labels using translations: `t('entryForm.foodEaten')`, etc.

7. **Add Translation Keys:**
   - Update `apps/food-diary/messages/nl.json` and `en.json`
   - Add entry form translations:
     ```json
     {
       "entryForm": {
         "foodEaten": "Food Eaten",
         "description": "Description",
         "date": "Date",
         "time": "Time",
         "submit": "Save Entry"
       }
     }
     ```

8. **Render `EntryForm` in Create Entry Page:**
   - Open `apps/food-diary/src/app/[locale]/entry/create/page.tsx`
   - Import and render `EntryForm` component
   - Ensure page is Server Component, form is Client Component

9. **Style Form:**
   - Use Tailwind classes for layout and spacing
   - Ensure form is responsive
   - Use design tokens for colors and spacing

10. **Document Server Validation Handoff:**
    - Ensure submit payload shape maps to Zod schemas in `apps/food-diary/src/lib/firestore/schemas.ts`
    - Note that server actions will be responsible for final validation before persistence

11. **Verify in Browser:**
    - Run `pnpm dev` from root
    - Navigate to `/[locale]/entry/create`
    - Verify form fields are visible and functional
    - Verify RAC validation messages appear on invalid fields
    - Test that translations are working (switch language)
    - Enter values and submit form (check console for logged data)

## 6. Acceptance Criteria

- `EntryForm.tsx` component created in `apps/food-diary/src/components/`
- Basic form structure implemented
- RAC `Form` is used for form semantics and submission
- `TextField` components from `@repo/ui` used for 'Food Eaten' and 'Description'
- `DatePicker` component from `@repo/ui` used for 'Date'
- `TextField` with `type="time"` used for 'Time'
- State management using `useState` implemented for all fields
- RAC validation wiring (`FieldError`/required constraints) implemented for these fields
- Story documents server-side Zod validation handoff to action layer
- All labels use translations from next-intl
- Translation keys added to `nl.json` and `en.json`
- Form is rendered in create entry page
- Form fields are visible and functional in browser
- Translations work correctly (Dutch and English)
- Basic `handleSubmit` function logs form data to console

## 7. Notes

- This is the first part of implementing the diary entry form
- The next part (009.2) will add complex fields (selects, chips, switch)
- Form will be enhanced with image upload and AI analysis in story 010-011
- Server action for saving will be implemented in story 012
- Ensure form is accessible (RAC semantics, labels, error states)
