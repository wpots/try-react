# User Story 009.2: Implement Diary Entry Form - Part 2 (Complex Fields)

## 1. Title

Implement complex form fields (Select, TagGroup, Switch) for emotions, location, company, behavior, skipped meal, and entry type.

## 2. Goal

To complete the diary entry form by adding all complex fields using shared UI components: Select dropdowns for location, company, and entry type; TagGroup for emotions and behaviors; and Switch for skipped meal toggle.

## 3. Description

As a developer, I need to add the remaining form fields to the diary entry form. These include dropdown selects for location, company, and entry type; multi-select chips for emotions and behaviors; and a toggle switch for skipped meal. All fields should use shared UI components and be fully translated.

## 4. Technical Details

- **Components:** Use `Select`, `TagGroup`, and `Switch` from `@repo/ui`
- **Form State:** Add state for new fields: `emotions`, `location`, `company`, `behavior`, `skippedMeal`, `entryType`
- **Options:** Define option arrays for selects and tag groups
- **i18n:** All options and labels should be translated

## 5. Steps to Implement

1. **Add State Variables:**
   - In `EntryForm.tsx`, add `useState` for:
     - `emotions` (Array of strings)
     - `location` (String)
     - `company` (String)
     - `behavior` (Array of strings)
     - `skippedMeal` (Boolean, default false)
     - `entryType` (String)

2. **Define Option Arrays:**
   - Create constants for select options:
     ```typescript
     const entryTypes = ["breakfast", "lunch", "dinner", "snack", "moment", "thought"];
     const locations = ["home", "work", "restaurant", "friend's house", "on the road", "family event"];
     const companies = ["family", "friends", "alone", "colleagues", "kids", "partner"];
     const emotionOptions = ["happy", "sad", "stressed", "anxious", "excited", "tired", "calm", "angry"];
     const behaviorOptions = ["mindful", "rushed", "emotional", "social", "bored", "celebratory"];
     ```

3. **Add Entry Type Select:**
   - Use `Select` component from `@repo/ui`
   - Connect to `entryType` state
   - Add label using translation: `t('entryForm.entryType')`
   - Map options to translated labels

4. **Add Location Select:**
   - Use `Select` component for location
   - Connect to `location` state
   - Add label: `t('entryForm.location')`
   - Map location options to translations

5. **Add Company Select:**
   - Use `Select` component for company
   - Connect to `company` state
   - Add label: `t('entryForm.company')`
   - Map company options to translations

6. **Add Emotions TagGroup:**
   - Use `TagGroup` component from `@repo/ui`
   - Connect to `emotions` state (multi-select)
   - Add label: `t('entryForm.emotions')`
   - Map emotion options to translations
   - Allow multiple selections

7. **Add Behavior TagGroup:**
   - Use `TagGroup` component for behaviors
   - Connect to `behavior` state (multi-select)
   - Add label: `t('entryForm.behavior')`
   - Map behavior options to translations
   - Allow multiple selections

8. **Add Skipped Meal Switch:**
   - Use `Switch` component from `@repo/ui`
   - Connect to `skippedMeal` state
   - Add label: `t('entryForm.skippedMeal')`

9. **Update Translation Files:**
   - Add all new translation keys to `nl.json` and `en.json`:
     ```json
     {
       "entryForm": {
         "entryType": "Entry Type",
         "location": "Location",
         "company": "Company",
         "emotions": "Emotions",
         "behavior": "Behavior",
         "skippedMeal": "Skipped Meal",
         "entryTypes": {
           "breakfast": "Breakfast",
           "lunch": "Lunch",
           "dinner": "Dinner",
           "snack": "Snack",
           "moment": "Moment",
           "thought": "Thought"
         },
         "locations": {
           "home": "Home",
           "work": "Work",
           "restaurant": "Restaurant",
           "friend's house": "Friend's House",
           "on the road": "On the Road",
           "family event": "Family Event"
         },
         "companies": {
           "family": "Family",
           "friends": "Friends",
           "alone": "Alone",
           "colleagues": "Colleagues",
           "kids": "Kids",
           "partner": "Partner"
         },
         "emotions": {
           "happy": "Happy",
           "sad": "Sad",
           "stressed": "Stressed",
           "anxious": "Anxious",
           "excited": "Excited",
           "tired": "Tired",
           "calm": "Calm",
           "angry": "Angry"
         },
         "behaviors": {
           "mindful": "Mindful",
           "rushed": "Rushed",
           "emotional": "Emotional",
           "social": "Social",
           "bored": "Bored",
           "celebratory": "Celebratory"
         }
       }
     }
     ```

10. **Update Form Layout:**
    - Organize fields logically (group related fields)
    - Use Tailwind for responsive grid layout
    - Ensure form is accessible (proper field grouping, labels)

11. **Update handleSubmit:**
    - Update `handleSubmit` to include all new fields in logged data
    - Verify all form data is captured correctly

12. **Test Form:**
    - Test all select dropdowns work correctly
    - Test TagGroup multi-select (emotions and behaviors)
    - Test Switch toggle
    - Verify all translations work
    - Test form validation (if any)

## 6. Acceptance Criteria

- All state variables added for new fields
- `Select` components used for entry type, location, and company
- `TagGroup` components used for emotions and behaviors (multi-select)
- `Switch` component used for skipped meal toggle
- All options are translated (Dutch and English)
- Translation keys added to `nl.json` and `en.json`
- Form layout is organized and responsive
- All fields are accessible (labels, keyboard navigation)
- Form captures all field values correctly
- Form is fully functional in browser

## 7. Notes

- This completes the basic diary entry form structure
- Image upload and AI analysis will be added in stories 010-011
- Form submission server action will be implemented in story 012
- Consider adding form validation in a later story
- TagGroup should support multiple selections for emotions and behaviors
- All option values should match Firestore data model (from story 007)
